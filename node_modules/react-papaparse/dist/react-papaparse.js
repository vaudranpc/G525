"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("papaparse"),t=require("react");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),o=n(t),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function u(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}function c(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.some((function(e){return!c(t)&&e&&e.apply(void 0,u([t],n)),c(t)}))}}function s(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}var f=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:"file-invalid-type",message:"File type must be ".concat(t)}};function d(e,t){var n="application/x-moz-file"===e.type||function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),r=e.name||"",o=(e.type||"").toLowerCase(),a=o.replace(/\/.*$/,"");return n.some((function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?r.toLowerCase().endsWith(t):t.endsWith("/*")?a===t.replace(/\/.*$/,""):o===t}))}return!0}(e,t);return[n,n?null:f(t)]}function p(e){return null!=e}var v=function(e){return{code:"file-too-large",message:"File is larger than ".concat(e," bytes")}},g=function(e){return{code:"file-too-small",message:"File is smaller than ".concat(e," bytes")}},m={code:"too-many-files",message:"Too many files"};function y(e){e.preventDefault()}function h(e,t){return r.default.parse(e,t)}function D(e,t){r.default.parse(e,Object.assign({},{download:!0},t))}function b(e,t){return void 0===t&&(t={}),r.default.unparse(e,t)}var F={Link:"link",Button:"button"};var E={progressBar:{borderRadius:3,boxShadow:"inset 0 1px 3px rgba(0, 0, 0, .2)",bottom:14,width:"100%"},button:{position:"inherit",width:"100%"},fill:{backgroundColor:"#659cef",borderRadius:3,height:10,transition:"width 500ms ease-in-out"}};function w(e){var n=e.style,r=e.className,a=e.display,i=t.useState(0),u=i[0],c=i[1];return t.useEffect((function(){c(e.percentage)}),[e.percentage]),o.default.createElement("span",{style:Object.assign({},E.progressBar,E.fill,n,{width:"".concat(u,"%"),display:a}),className:r})}function C(e){var t=e.color,n=e.width,r=void 0===n?23:n,a=e.height,i=void 0===a?23:a;return o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:i,viewBox:"0 0 512 512"},o.default.createElement("path",{fill:t,d:"M504.1 256C504.1 119 393 7.9 256 7.9S7.9 119 7.9 256 119 504.1 256 504.1 504.1 393 504.1 256z"}),o.default.createElement("path",{fill:"#FFF",d:"M285 256l72.5-84.2c7.9-9.2 6.9-23-2.3-31-9.2-7.9-23-6.9-30.9 2.3L256 222.4l-68.2-79.2c-7.9-9.2-21.8-10.2-31-2.3-9.2 7.9-10.2 21.8-2.3 31L227 256l-72.5 84.2c-7.9 9.2-6.9 23 2.3 31 4.1 3.6 9.2 5.3 14.3 5.3 6.2 0 12.3-2.6 16.6-7.6l68.2-79.2 68.2 79.2c4.3 5 10.5 7.6 16.6 7.6 5.1 0 10.2-1.7 14.3-5.3 9.2-7.9 10.2-21.8 2.3-31L285 256z"}))}function P(){var e=function(e){var n=e.children,f=e.accept,h=void 0===f?"text/csv, .csv, application/vnd.ms-excel":f,D=e.config,b=void 0===D?{}:D,F=e.minSize,E=void 0===F?0:F,P=e.maxSize,x=void 0===P?1/0:P,S=e.maxFiles,O=void 0===S?1:S,R=e.disabled,A=void 0!==R&&R,L=e.noClick,T=void 0!==L&&L,j=e.noDrag,z=void 0!==j&&j,M=e.noDragEventsBubbling,I=void 0!==M&&M,_=e.noKeyboard,K=void 0!==_&&_,N=e.multiple,U=void 0!==N&&N,V=e.preventDropOnDocument,W=void 0===V||V,q=e.onUploadAccepted,$=e.validator,G=e.onUploadRejected,H=e.onDragEnter,J=e.onDragOver,Q=e.onDragLeave,X=t.useRef(null),Y=t.useRef(null),Z=t.useRef([]),ee=t.useReducer(k,B),te=ee[0],ne=ee[1],re=te.acceptedFile,oe=te.displayProgressBar,ae=te.progressBarPercentage,ie=te.draggedFiles,ue=te.isFileDialogActive,ce=function(e){Y.current&&Y.current.contains(e.target)||(e.preventDefault(),Z.current=[])};t.useEffect((function(){return W&&(document.addEventListener("dragover",y,!1),document.addEventListener("drop",ce,!1)),function(){W&&(document.removeEventListener("dragover",y),document.removeEventListener("drop",ce))}}),[Y,W]);var le=function(e){return A?null:e},se=function(e){return z?null:le(e)},fe=function(e){I&&e.stopPropagation()},de=function(e){e.preventDefault(e),e.persist(),fe(e)},pe=function(e){ne({displayProgressBar:e,type:"setDisplayProgressBar"})},ve=function(e){ne({progressBarPercentage:e,type:"setProgressBarPercentage"})},ge=function(e){return o.default.createElement(w,a({display:oe,percentage:ae},e))},me=function(e){return o.default.createElement(C,a({},e))},ye=t.useCallback((function(){X.current&&te.displayProgressBar&&(ne({type:"openDialog"}),X.current.value=null,X.current.click())}),[ne]),he=function(){ue&&setTimeout((function(){X.current&&(X.current.files.length||ne({type:"closeDialog"}))}),300)};t.useEffect((function(){return window.addEventListener("focus",he,!1),function(){window.removeEventListener("focus",he,!1)}}),[X,ue]);var De=t.useCallback((function(){var e;T||(void 0===e&&(e=window.navigator.userAgent),function(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}(e)||function(e){return-1!==e.indexOf("Edge/")}(e)?setTimeout(ye,0):ye())}),[X,T]),be=t.useCallback((function(e){if(de(e),ve(0),Z.current=[],s(e)){if(c(e)&&!I)return;var t=[],n=[],o=e.target.files||e.dataTransfer&&e.dataTransfer.files;if(Array.from(o).forEach((function(e){var r=d(e,h),o=r[0],a=r[1],i=function(e,t,n){if(p(e.size))if(p(t)&&p(n)){if(e.size>n)return[!1,v(n)];if(e.size<t)return[!1,g(t)]}else{if(p(t)&&e.size<t)return[!1,g(t)];if(p(n)&&e.size>n)return[!1,v(n)]}return[!0,null]}(e,E,x),u=i[0],c=i[1],l=$?$(e):null;if(o&&u&&!l)t.push(e);else{var s=[a,c];l&&(s=s.concat(l)),n.push({file:e,errors:s.filter((function(e){return e}))})}})),(!U&&t.length>1||U&&O>=1&&t.length>O)&&(t.forEach((function(e){n.push({file:e,errors:[m]})})),t.splice(0)),ne({acceptedFiles:t,fileRejections:n,type:"setFiles"}),pe("block"),n.length>0&&G&&G(n,e),t.length>0&&q){var a={},i=[],u=[],l=[],f=new window.FileReader,y=0;t.forEach((function(e){ne({acceptedFile:e,type:"setFile"}),a={complete:(null==b?void 0:b.complete)||(null==b?void 0:b.step)?b.complete:function(){q({data:i,errors:u,meta:l},e)},step:(null==b?void 0:b.step)?b.step:function(t){if(i.push(t.data),t.errors.length>0&&u.push(t.errors),t.length>0&&l.push(t[0].meta),b&&b.preview)y=Math.round(i.length/b.preview*100),i.length===b.preview&&q(i,e);else{var n=t.meta.cursor,r=Math.round(n/e.size*100);if(r===y)return;y=r}ve(y)}},a=Object.assign({},b,a),f.onload=function(e){r.default.parse(e.target.result,a)},f.onloadend=function(){setTimeout((function(){pe("none")}),2e3)},f.readAsText(e,b.encoding||"utf-8")}))}}}),[U,h,E,x,O,$,q]),Fe=t.useCallback((function(e){fe(e)}),[]),Ee=function(e){return K?null:le(e)},we=t.useCallback((function(e){if(de(e),Z.current=u(u([],Z.current),[e.target]),s(e)){if(c(e)&&!I)return;ne({draggedFiles:ie,isDragActive:!0,type:"setDraggedFiles"}),H&&H(e)}}),[H,I]),Ce=t.useCallback((function(e){de(e);var t=s(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(e){}return t&&J&&J(e),!1}),[J,I]),Pe=t.useCallback((function(e){de(e);var t=Z.current.filter((function(e){return Y.current&&Y.current.contains(e)})),n=t.indexOf(e.target);-1!==n&&t.splice(n,1),Z.current=t,t.length>0||(ne({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),s(e)&&Q&&Q(e))}),[Y,Q,I]),Be=t.useCallback((function(e){Y.current&&Y.current.isEqualNode(e.target)&&("Space"!==e.key&&"Enter"!==e.key||(e.preventDefault(),ye()))}),[Y,X]),ke=t.useCallback((function(){ne({type:"focus"})}),[]),xe=t.useCallback((function(){ne({type:"blur"})}),[]),Se=t.useMemo((function(){return function(e){void 0===e&&(e={});var t=e.onClick,n=void 0===t?function(){}:t,r=e.onDrop,o=void 0===r?function(){}:r,u=e.onDragOver,c=void 0===u?function(){}:u,s=e.onDragLeave,f=void 0===s?function(){}:s,d=e.onKeyDown,p=void 0===d?function(){}:d,v=e.onFocus,g=void 0===v?function(){}:v,m=e.onBlur,y=void 0===m?function(){}:m,h=e.onDragEnter,D=void 0===h?function(){}:h,b=i(e,["onClick","onDrop","onDragOver","onDragLeave","onKeyDown","onFocus","onBlur","onDragEnter"]);return a({onClick:le(l(n,De)),onDrop:se(l(o,be)),onDragEnter:se(l(D,we)),onDragOver:se(l(c,Ce)),onDragLeave:se(l(f,Pe)),onKeyDown:Ee(l(p,Be)),onFocus:Ee(l(g,ke)),onBlur:Ee(l(y,xe))},b)}}),[Y,Be,ke,xe,De,we,Ce,Pe,be,K,z,A]),Oe=t.useMemo((function(){return function(e){var t;void 0===e&&(e={});var n=e.refKey,r=void 0===n?"ref":n,o=e.onChange,u=void 0===o?function(){}:o,c=e.onClick,s=void 0===c?function(){}:c,f=i(e,["refKey","onChange","onClick"]),d=((t={accept:h,multiple:U,type:"file",style:{display:"none"},onChange:le(l(u,be)),onClick:le(l(s,Fe)),autoComplete:"off",tabIndex:-1})[r]=X,t);return a(a({},d),f)}}),[X,h,be,A]),Re=t.useCallback((function(e){X.current.value="",ne({type:"reset"}),e.stopPropagation()}),[]),Ae=t.useMemo((function(){return function(e){void 0===e&&(e={});var t=e.onClick,n=void 0===t?function(){}:t,r=i(e,["onClick"]);return a({onClick:le(l(n,Re))},r)}}),[Re]);return o.default.createElement(o.default.Fragment,null,o.default.createElement("input",a({},Oe())),n({getRootProps:Se,acceptedFile:re,ProgressBar:ge,getRemoveFileProps:Ae,Remove:me}))};return t.useMemo((function(){return e}),[])}var B={displayProgressBar:"none",progressBarPercentage:0,isDragActive:!1,isFileDialogActive:!1,isFocused:!1,draggedFiles:[],acceptedFiles:[],acceptedFile:null};function k(e,t){switch(t.type){case"openDialog":return a(a({},e),{isFileDialogActive:!0});case"closeDialog":return a(a({},e),{isFileDialogActive:!1});case"setFiles":return a(a({},e),{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"setFile":return a(a({},e),{acceptedFile:t.acceptedFile});case"setDisplayProgressBar":return a(a({},e),{displayProgressBar:t.displayProgressBar});case"setProgressBarPercentage":return a(a({},e),{progressBarPercentage:t.progressBarPercentage});case"setDraggedFiles":var n=t.isDragActive,r=t.draggedFiles;return a(a({},e),{draggedFiles:r,isDragActive:n});case"focus":return a(a({},e),{isFocused:!0});case"blur":return a(a({},e),{isFocused:!1});case"reset":return a({},B);default:return e}}var x=r.default.BAD_DELIMITERS,S=r.default.RECORD_SEP,O=r.default.UNIT_SEP,R=r.default.WORKERS_SUPPORTED,A=r.default.LocalChunkSize,L=r.default.DefaultDelimiter;exports.BAD_DELIMITERS=x,exports.DefaultDelimiter=L,exports.LocalChunkSize=A,exports.RECORD_SEP=S,exports.UNIT_SEP=O,exports.WORKERS_SUPPORTED=R,exports.formatFileSize=function(e){var t=1024,n=1048576,r=1073741824;if(e<n){var o=Number((e/t).toFixed(0));return o<=0?e+" B":o+" KB"}return e<r?(e/n).toFixed(0)+" MB":e<1099511627776?(e/r).toFixed(0)+" GB":""},exports.lightenDarkenColor=function(e,t){var n=!1;"#"==e[0]&&(e=e.slice(1),n=!0);var r=parseInt(e,16),o=(r>>16)+t;o>255?o=255:o<0&&(o=0);var a=(r>>8&255)+t;a>255?a=255:a<0&&(a=0);var i=(255&r)+t;return i>255?i=255:i<0&&(i=0),(n?"#":"")+(i|a<<8|o<<16).toString(16)},exports.useCSVDownloader=function(){var e;return{CSVDownloader:(e=function(e){var t=e.children,n=e.data,a=void 0===n?{}:n,i=e.filename,u=e.type,c=void 0===u?F.Link:u,l=e.style,s=void 0===l?{}:l,f=e.className,d=void 0===f?"":f,p=e.bom,v=void 0!==p&&p,g=e.config,m=void 0===g?{}:g,y=function(){var e=v?"\ufeff":"",t=null,n=null;"function"==typeof a&&(a=a()),t="object"==typeof a?r.default.unparse(a,m):a;var o=new Blob(["".concat(e).concat(t)],{type:"text/csv;charset=utf-8;"}),u=window.navigator;n=u.msSaveBlob?u.msSaveBlob(o,"".concat(i,".csv")):window.URL.createObjectURL(o);var c=document.createElement("a");c.href=n,c.setAttribute("download","".concat(i,".csv")),c.click(),c.remove()};return o.default.createElement(o.default.Fragment,null,c===F.Button?o.default.createElement("button",{onClick:function(){return y()},style:s,className:d},t):o.default.createElement("a",{onClick:function(){return y()},style:s,className:d},t))},o.default.useMemo((function(){return e}),[])),Type:F}},exports.useCSVReader=function(){return{CSVReader:P()}},exports.usePapaParse=function(){return{readString:h,readRemoteFile:D,jsonToCSV:b}};
